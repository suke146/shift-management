# シフト管理システム

アルバイトのシフト提出・管理・閲覧ができるWebアプリケーションです。

## 機能

### 一般ユーザー
- ログイン/新規登録
- シフトの提出(週単位で勤務可能日時を登録)
- 確定シフトの閲覧(週単位のカレンダー表示)

### 管理者
- 全ての一般ユーザー機能
- 全メンバーのシフト提出状況の確認
- 確定シフトの作成
- メンバー管理(権限変更、削除)

## 技術スタック

- **フロントエンド**: HTML5, CSS3, JavaScript
- **バックエンド**: PHP 7.4+
- **データベース**: MySQL 5.7+
- **その他**: セッション管理、レスポンシブデザイン

## セットアップ方法

### 1. 必要な環境
- PHP 7.4以上
- MySQL 5.7以上
- Webサーバー(Apache, Nginx等)

### 2. データベースのセットアップ

```bash
# MySQLにログイン
mysql -u root -p

# SQLファイルを実行
source config/setup.sql
```

または、phpMyAdminなどのツールで `config/setup.sql` を実行してください。

### 3. データベース接続設定

`config/db.php` を編集して、データベース接続情報を設定します:

```php
$host = 'localhost';
$dbname = 'shift_management';
$username = 'root';  // MySQLのユーザー名
$password = '';      // MySQLのパスワード
```

### 4. Webサーバーの設定

#### XAMPPを使用する場合
1. このプロジェクトフォルダを `C:\xampp\htdocs\shift_management` に配置
2. XAMPPコントロールパネルでApacheとMySQLを起動
3. ブラウザで `http://localhost/shift_management` にアクセス

#### 組み込みPHPサーバーを使用する場合
```bash
cd shift_management
php -S localhost:8000
```
ブラウザで `http://localhost:8000` にアクセス

### 5. デフォルト管理者アカウント

初回ログイン用の管理者アカウント:
- メールアドレス: `admin@example.com`
- パスワード: `admin123`

**セキュリティのため、初回ログイン後にパスワードを変更することを推奨します。**

## 外部からのアクセス設定

### ローカルネットワーク内からのアクセス

1. サーバーのローカルIPアドレスを確認:
   ```bash
   ipconfig  # Windows
   ```

2. PHPサーバーを外部アクセス可能に起動:
   ```bash
   php -S 0.0.0.0:8000
   ```

3. 同じネットワーク内の他のデバイスから `http://[サーバーのIP]:8000` でアクセス

### インターネットからのアクセス

以下のいずれかの方法を使用:

#### 方法1: レンタルサーバーにデプロイ
- さくらインターネット、ロリポップ、エックスサーバーなど
- FTPでファイルをアップロード
- データベースを作成し、接続情報を更新

#### 方法2: クラウドサービスを利用
- Heroku、AWS、Google Cloud、Azureなど
- 無料枠を利用可能

#### 方法3: ポートフォワーディング(非推奨)
- ルーターの設定でポート80/443を開放
- セキュリティリスクが高いため本番環境では推奨しません

## ファイル構成

```
shift_management/
├── index.php              # ログイン・新規登録ページ
├── dashboard.php          # メインダッシュボード
├── logout.php             # ログアウト処理
├── config/
│   ├── db.php            # データベース接続設定
│   └── setup.sql         # データベース初期化SQL
├── api/
│   ├── auth.php          # 認証API
│   ├── shift.php         # シフトAPI
│   └── admin.php         # 管理者API
├── css/
│   ├── style.css         # 共通スタイル
│   └── dashboard.css     # ダッシュボード用スタイル
├── js/
│   ├── auth.js           # 認証処理
│   ├── dashboard.js      # ダッシュボード制御
│   ├── shift.js          # シフト処理
│   └── admin.js          # 管理者機能
└── README.md             # このファイル
```

## 使用方法

### シフトの提出
1. ダッシュボードの「シフト提出」をクリック
2. 対象週を選択
3. 勤務可能な曜日のチェックボックスをオンにし、時間を入力
4. 「シフトを提出」ボタンをクリック

### シフトの閲覧
1. ダッシュボードの「シフト閲覧」をクリック
2. 週の切り替えボタンで閲覧したい週を選択
3. 確定したシフトが表にビュー表示されます

### 管理者機能
1. ダッシュボードの「シフト管理」で全員の提出を確認
2. 採用したいシフトにチェックを入れる
3. 「確定シフトを作成」ボタンで確定
4. 「メンバー管理」でユーザーの権限変更や削除が可能

## セキュリティについて

- パスワードは `password_hash()` で暗号化して保存
- セッション管理によるアクセス制御
- 管理者権限のチェック
- SQLインジェクション対策(プリペアドステートメント使用)
- XSS対策(`htmlspecialchars()` による出力エスケープ)

## トラブルシューティング

### データベース接続エラー
- `config/db.php` の設定を確認
- MySQLサービスが起動しているか確認
- データベースが作成されているか確認

### ログインできない
- デフォルト管理者アカウントで試す
- ブラウザのキャッシュをクリア
- セッションファイルのパーミッションを確認

### シフトが表示されない
- ブラウザの開発者ツールでAPIエラーを確認
- データベースにデータが登録されているか確認

## 今後の拡張機能案

- メール通知機能
- シフト変更申請機能
- 勤務時間の集計・給与計算
- カレンダーエクスポート(iCal形式)
- スマホアプリ化
- LINE連携

## ライセンス

このプロジェクトはMITライセンスの下で公開されています。

## サポート

問題が発生した場合は、開発者に連絡してください。
